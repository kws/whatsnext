(this.webpackJsonpwhatsnext=this.webpackJsonpwhatsnext||[]).push([[0],{14:function(e,t,n){},17:function(e,t,n){"use strict";n.r(t),n.d(t,"msalInstance",(function(){return A}));var c=n(0),r=n(7),a=n.n(r),o=(n(14),n(3)),s=n(9),i=n(1),u=window.navigator.userAgent,l=(u.indexOf("MSIE "),u.indexOf("Trident/"),u.indexOf("Edge/"),u.indexOf("Firefox"),{scopes:["User.Read","Calendars.Read"]}),d=new Date;d.setHours(0),d.setMinutes(0),d.setSeconds(0);var h=d.toISOString();d.setDate(d.getDate()+1);var b=d.toISOString(),j={graphMeEndpoint:"https://graph.microsoft.com/v1.0/me/calendar/calendarView?StartDateTime=".concat(h,"&EndDateTime=").concat(b)},g=n(5),f=n.n(g),p=n(6),O=n(8);function v(){return(v=Object(O.a)(f.a.mark((function e(){var t,n,c,r,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=A.getActiveAccount()){e.next=3;break}throw Error("No active account! Verify a user has been signed in and setActiveAccount has been called.");case 3:return e.next=5,A.acquireTokenSilent(Object(p.a)(Object(p.a)({},l),{},{account:t}));case 5:return n=e.sent,c=new Headers,r="Bearer ".concat(n.accessToken),c.append("Authorization",r),a={method:"GET",headers:c},e.abrupt("return",fetch(j.graphMeEndpoint,a).then((function(e){return e.json()})).catch((function(e){return console.log(e)})));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var x=n(2),m=function(){var e=Object(o.b)().inProgress,t=Object(c.useState)(null),n=Object(s.a)(t,2),r=n[0],a=n[1];Object(c.useEffect)((function(){e===i.c.None&&function(){return v.apply(this,arguments)}().then((function(e){return a(e)}))}),[e]),console.log("GraphData",r);var u=r&&r.value?r.value:[];return u.sort((function(e,t){return e.start.dateTime.localeCompare(t.start.dateTime)})),console.log("events",u),Object(x.jsx)("ul",{children:u.map((function(e){return Object(x.jsxs)("li",{children:[new Date(e.start.dateTime).toLocaleTimeString()," - ",e.subject]})}))})};var w=function(){var e=Object(o.b)(),t=e.instance,n=e.accounts,c=e.inProgress;return console.log("Accounts",n),n.length>0?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("p",{children:["There are currently ",n.length," users signed in! "]}),Object(x.jsx)(m,{}),Object(x.jsx)("button",{onClick:function(){return t.logout()},children:"Logout"})]}):"login"===c?Object(x.jsx)("span",{children:"Login is currently in progress!"}):Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("span",{children:"There are currently no users signed in!"}),Object(x.jsx)("button",{onClick:function(){return t.loginPopup()},children:"Login"})]})},A=new i.g({auth:{clientId:"34a2dfb8-fcb2-4c55-8436-ed03b6b7c683"}}),S=A.getAllAccounts();S.length>0&&A.setActiveAccount(S[0]),A.addEventCallback((function(e){if(e.eventType===i.b.LOGIN_SUCCESS&&e.payload.account){var t=e.payload.account;A.setActiveAccount(t)}}));var T=function(){return Object(x.jsx)(o.a,{instance:A,children:Object(x.jsx)(w,{})})};a.a.render(Object(x.jsx)(T,{}),document.getElementById("root"))}},[[17,1,2]]]);
//# sourceMappingURL=main.fd6a6afe.chunk.js.map