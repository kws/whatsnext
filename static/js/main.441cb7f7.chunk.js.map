{"version":3,"sources":["authConfig.js","utils/MsGraphApiCall.js","components/Event.js","components/Calendar.js","App.js","index.js"],"names":["ua","window","navigator","userAgent","msie","indexOf","msie11","msedge","firefox","msalConfig","auth","clientId","authority","redirectUri","cache","cacheLocation","storeAuthStateInCookie","system","loggerOptions","loggerCallback","level","message","containsPii","LogLevel","Error","console","error","Info","info","Verbose","debug","Warning","warn","loginRequest","scopes","d","Date","setHours","setMinutes","setSeconds","start","toISOString","setDate","getDate","end","graphConfig","graphMeEndpoint","callMsGraph","a","account","msalInstance","getActiveAccount","acquireTokenSilent","response","headers","Headers","bearer","accessToken","append","options","method","fetch","then","json","catch","log","_0","value","padStart","getBlendColors","diff","alphaValue","Math","min","greenValue","max","redValue","r","easeInOutCubic","g","backgroundColor","Event","event","diffInSecs","floor","timeinfo","timeDiff","absDiff","abs","hours","minutes","seconds","timeRep","flashClass","pastClass","className","style","startRep","subject","loadAndPrepareData","graphData","events","sort","b","dateTime","localeCompare","map","getHours","getMinutes","Calendar","inProgress","useMsal","useState","setEvents","getTime","time","setTime","useEffect","InteractionStatus","None","timer","setInterval","clearInterval","RELOAD_INTERVAL_IN_MINUTES","started","ended","currentEvents","filter","currentTime","toLocaleTimeString","timeStyle","replace","id","App","instance","accounts","length","onClick","acquireTokenPopup","Sentry","dsn","integrations","Integrations","BrowserTracing","tracesSampleRate","PublicClientApplication","getAllAccounts","setActiveAccount","addEventCallback","eventType","EventType","LOGIN_SUCCESS","payload","AppProvider","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.441cb7f7.chunk.js","sourcesContent":["import { LogLevel } from \"@azure/msal-browser\";\n// Browser check variables\n// If you support IE, our recommendation is that you sign-in using Redirect APIs\n// If you as a developer are testing using Edge InPrivate mode, please add \"isEdge\" to the if check\nconst ua = window.navigator.userAgent;\nconst msie = ua.indexOf(\"MSIE \");\nconst msie11 = ua.indexOf(\"Trident/\");\nconst msedge = ua.indexOf(\"Edge/\");\nconst firefox = ua.indexOf(\"Firefox\");\nconst isIE = msie > 0 || msie11 > 0;\nconst isEdge = msedge > 0;\nconst isFirefox = firefox > 0; // Only needed if you need to support the redirect flow in Firefox incognito\n\n// Config object to be passed to Msal on creation\nexport const msalConfig = {\n    auth: {\n        clientId: \"212b434a-82b7-43bb-b48d-c8921a2e939d\",\n        authority: \"https://login.microsoftonline.com/common\",\n        redirectUri: \"/whatsnext/\"\n    },\n    cache: {\n        cacheLocation: \"sessionStorage\", // This configures where your cache will be stored\n        storeAuthStateInCookie: isIE || isEdge || isFirefox\n    },\n    system: {\n        loggerOptions: {\n            loggerCallback: (level, message, containsPii) => {\n                if (containsPii) {\n                    return;\n                }\n                switch (level) {\n                    case LogLevel.Error:\n                        console.error(message);\n                        return;\n                    case LogLevel.Info:\n                        console.info(message);\n                        return;\n                    case LogLevel.Verbose:\n                        console.debug(message);\n                        return;\n                    case LogLevel.Warning:\n                        console.warn(message);\n                        return;\n                    default:\n                        return;\n                }\n            }\n        }\n    }\n};\n\n// Add here scopes for id token to be used at MS Identity Platform endpoints.\nexport const loginRequest = {\n    scopes: [\"User.Read\", \"Calendars.Read\"]\n};\n\nconst d = new Date();\nd.setHours(0);\nd.setMinutes(0);\nd.setSeconds(0)\n\nconst start=d.toISOString();\n\nd.setDate(d.getDate() + 1)\n\nconst end=d.toISOString();\n\n// Add here the endpoints for MS Graph API services you would like to use.\nexport const graphConfig = {\n    graphMeEndpoint: `https://graph.microsoft.com/v1.0/me/calendar/calendarView?StartDateTime=${start}&EndDateTime=${end}`\n};","import { loginRequest, graphConfig } from \"../authConfig\";\nimport { msalInstance } from \"../index\";\n\nexport async function callMsGraph() {\n    const account = msalInstance.getActiveAccount();\n    if (!account) {\n        throw Error(\"No active account! Verify a user has been signed in and setActiveAccount has been called.\");\n    }\n\n    const response = await msalInstance.acquireTokenSilent({\n        ...loginRequest,\n        account: account\n    });\n\n    const headers = new Headers();\n    const bearer = `Bearer ${response.accessToken}`;\n\n    headers.append(\"Authorization\", bearer);\n\n    const options = {\n        method: \"GET\",\n        headers: headers\n    };\n\n    return fetch(graphConfig.graphMeEndpoint, options)\n        .then(response => response.json())\n        .catch(error => console.log(error));\n}","import React from 'react'\nimport {easeInOutCubic} from 'js-easing-functions';\nconst _0 = (value) => {\n    return `${value}`.padStart(2, '0')\n}\n\nconst getBlendColors = diff => {\n    // 900 - 15 minutes\n    // 600 - 10 minutes\n    // 300 - 5 minutes\n    if (diff > 900 | diff < -300) {\n        return {}\n    }\n    const alphaValue = Math.min(300, 900 - diff);\n    const greenValue = Math.max(0, Math.min(300, diff));\n    const redValue = Math.max(0, Math.min(300, 600-diff));\n\n    console.log(`R: ${redValue} G:${greenValue} A:${alphaValue}`)\n\n    const r = easeInOutCubic(redValue, 0, 128, 300);\n    const g = easeInOutCubic(greenValue, 0, 128, 300);\n    const a = easeInOutCubic(alphaValue, 0, 1,300);\n\n    console.log(`R: ${r} G:${g} A:${a}`)\n\n    return {backgroundColor: `rgba(${r}, ${g}, 0, ${a})`};\n}\n\nconst Event = ({event}) => {\n    const diffInSecs = Math.floor(event.timeinfo.timeDiff / 1000);\n    const absDiff = Math.abs(diffInSecs);\n    const hours = Math.floor(absDiff /  3600 )\n    const minutes = Math.floor(absDiff / 60 - (hours * 60))\n    const seconds = Math.floor(absDiff - (hours * 3600) - (minutes * 60))\n\n    let timeRep = \"\";\n    if (event.timeinfo.timeDiff < 0) {\n        timeRep += 'T+ ';\n    }\n    if (hours > 0) {\n        timeRep += `${hours}h ${_0(minutes)}m`;\n    } else if (minutes > 9) {\n        timeRep += `${minutes}m`;\n    } else {\n        timeRep += `${minutes}m ${_0(seconds)}s`;\n    }\n\n    const flashClass = diffInSecs < 60 && diffInSecs > -300 ? 'flash': '';\n    const pastClass = diffInSecs < -300 ? 'past': '';\n\n    return (\n        <li className={`event ${flashClass} ${pastClass}`}\n            style={diffInSecs > 60 ? getBlendColors(diffInSecs) : {}}>\n            <span className=\"time\">{event.timeinfo.startRep}</span>\n            <span className=\"title\">{event.subject}</span>\n            <span className=\"diff\">{timeRep}</span>\n        </li>\n    )\n};\n\nexport default Event;","import React from 'react'\nimport { useEffect, useState } from \"react\";\n\nimport { useMsal } from \"@azure/msal-react\";\nimport { InteractionStatus } from \"@azure/msal-browser\";\n\nimport { callMsGraph } from \"../utils/MsGraphApiCall\";\nimport Event from \"./Event\";\n\nconst RELOAD_INTERVAL_IN_MINUTES = 1;\n\nconst loadAndPrepareData = async () => {\n    const graphData = await callMsGraph();\n    const events = (graphData && graphData.value) ? graphData.value : [];\n    events.sort((a, b) => a.start.dateTime.localeCompare(b.start.dateTime));\n    events.map(event => {\n        const start = new Date(event.start.dateTime+\"Z\")\n        const end = new Date(event.end.dateTime+\"Z\")\n        const startRep = `${start.getHours()}`.padStart(2, '0') + ':' +`${start.getMinutes()}`.padStart(2, '0')\n        event.timeinfo = {start, end, startRep}\n        return event;\n    });\n    console.log(\"events\", events);\n    return events;\n};\n\nconst Calendar = () => {\n    const { inProgress } = useMsal();\n    const [events, setEvents] = useState([]);\n    const [time, setTime] = useState(new Date().getTime());\n\n    useEffect(() => {\n        if (inProgress === InteractionStatus.None) {\n            loadAndPrepareData().then(events => {\n                setEvents(events);\n            });\n        }\n    }, [inProgress]);\n\n    useEffect(() => {\n        const timer = setInterval(() => {\n            setTime(new Date().getTime());\n        }, 1000);\n        return () => {\n            console.log(\"Stopping timer\");\n            clearInterval(timer);\n        }\n    },[]);\n\n    useEffect(() => {\n        const timer = setInterval(() => {\n            if (inProgress === InteractionStatus.None) {\n                loadAndPrepareData().then(events => {\n                    setEvents(events);\n                });\n            }\n        }, RELOAD_INTERVAL_IN_MINUTES * 60 * 1000);\n        return () => {\n            console.log(\"Stopping timer\");\n            clearInterval(timer);\n        }\n    }, [inProgress]);\n\n    events.map(event => {\n        event.timeinfo.timeDiff = event.timeinfo.start - time;\n        event.timeinfo.started = event.timeinfo.start >= time;\n        event.timeinfo.ended = event.timeinfo.end >= time;\n        return event;\n    });\n\n    const currentEvents = events.filter(event => event.timeinfo.ended)\n\n    let currentTime = new Date(time).toLocaleTimeString(\"en-GB\",{timeStyle: 'short'})\n    if ((Math.floor(time / 1000)) % 2 === 0) {\n        currentTime = currentTime.replace(\":\", \" \");\n    }\n\n    return (\n        <>\n            <div className=\"timeDisplay\">{currentTime}</div>\n            <ul>\n                {currentEvents.map(event => <Event key={event.id} event={event}/>)}\n            </ul>\n        </>\n    )\n\n}\n\nexport default Calendar;","import React from 'react'\nimport { useMsal } from \"@azure/msal-react\";\nimport Calendar from \"./components/Calendar\";\nimport { loginRequest } from \"./authConfig\";\n\nexport function App() {\n    const { instance, accounts, inProgress } = useMsal();\n    if (accounts.length > 0) {\n        return (\n            <Calendar />\n        )\n    } else if (inProgress === \"login\") {\n        return <div>Login is currently in progress!</div>\n    } else {\n        return (\n            <div>\n                <span>Please log in to view your upcoming events.</span>\n                <button onClick={() => instance.acquireTokenPopup(loginRequest)}>Login</button>\n            </div>\n        );\n    }\n}\n\nexport default App;","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport * as Sentry from \"@sentry/react\";\nimport { Integrations } from \"@sentry/tracing\";\nimport { MsalProvider } from \"@azure/msal-react\";\nimport { PublicClientApplication, EventType } from \"@azure/msal-browser\";\nimport { msalConfig } from \"./authConfig\"\nimport './index.css';\nimport App from './App';\n\nSentry.init({\n    dsn: \"https://c42f3190b1094dd4b4dd426834da98c6@o108858.ingest.sentry.io/5662792\",\n    integrations: [new Integrations.BrowserTracing()],\n    tracesSampleRate: 1.0,\n});\n\nexport const msalInstance = new PublicClientApplication(msalConfig);\n\nconst accounts = msalInstance.getAllAccounts();\nif (accounts.length > 0) {\n    msalInstance.setActiveAccount(accounts[0]);\n}\n\nmsalInstance.addEventCallback((event) => {\n    console.log(\"msalInstance event\", event)\n    if (event.eventType === EventType.LOGIN_SUCCESS && event.payload.account) {\n        const account = event.payload.account;\n        msalInstance.setActiveAccount(account);\n    }\n});\n\n// Component\nconst AppProvider = () => (\n    <MsalProvider instance={msalInstance}>\n        <App />\n    </MsalProvider>\n);\n\n\nReactDOM.render(<AppProvider />, document.getElementById(\"root\"));\n\n"],"sourceRoot":""}