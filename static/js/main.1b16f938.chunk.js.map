{"version":3,"sources":["components/Event.module.css","components/MadeByKaj.module.css","components/Welcome.module.css","components/Calendar.module.css","authConfig.js","utils/MsGraphApiCall.js","components/Event.js","components/MadeByKaj.js","components/Calendar.js","components/Welcome.js","App.js","index.js"],"names":["module","exports","ua","window","navigator","userAgent","msie","indexOf","msie11","msedge","firefox","msalConfig","auth","clientId","process","authority","redirectUri","cache","cacheLocation","storeAuthStateInCookie","system","loggerOptions","loggerCallback","level","message","containsPii","LogLevel","Error","console","error","Info","info","Verbose","debug","Warning","warn","loginRequest","scopes","graphConfig","callMsGraph","a","account","msalInstance","getActiveAccount","acquireTokenSilent","response","headers","Headers","bearer","accessToken","append","options","method","start","dayjs","subtract","end","add","url","toISOString","fetch","then","json","catch","log","_0","value","padStart","getBlendColors","diff","alphaValue","Math","min","greenValue","max","redValue","r","easeInOutCubic","g","backgroundColor","formatCountdown","event","diffInSecs","floor","timeinfo","timeDiff","absDiff","abs","hours","minutes","seconds","timeRep","Event","flashClass","styles","flash","pastClass","past","className","classNames","style","time","startRep","title","subject","requestFullscreen","document","fullscreenElement","exitFullscreen","documentElement","MadeByKaj","love","href","forkongithub","fullScreen","onClick","loadAndPrepareData","graphData","events","sort","b","dateTime","localeCompare","map","Date","format","Calendar","inProgress","useMsal","useState","setEvents","getTime","setTime","useEffect","InteractionStatus","None","timer","setInterval","clearInterval","RELOAD_INTERVAL_IN_MINUTES","timeDiffSecs","offsetDiff","alertStatus","started","ended","currentEvents","filter","isAllDay","isCancelled","maxAlertStatus","reduce","currentTime","replace","nextEvent","length","icon","Helmet","replaceAll","rel","timeDisplay","id","Welcome","instance","intro","msauth","acquireTokenPopup","App","Component","accounts","SENTRY_DSN","Sentry","dsn","integrations","Integrations","BrowserTracing","tracesSampleRate","PublicClientApplication","getAllAccounts","setActiveAccount","addEventCallback","eventType","EventType","LOGIN_SUCCESS","payload","AppProvider","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.1b16f938.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"event\":\"Event_event__1P29_\",\"time\":\"Event_time__2-mok\",\"title\":\"Event_title__2DQ5v\",\"diff\":\"Event_diff__1q_Qg\",\"past\":\"Event_past__VN_ps\",\"flash\":\"Event_flash__3EET6\",\"alert\":\"Event_alert__1gP6J\",\"blinker\":\"Event_blinker__9dt53\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"love\":\"MadeByKaj_love__39zpn\",\"forkongithub\":\"MadeByKaj_forkongithub__1xnhH\",\"fullScreen\":\"MadeByKaj_fullScreen__3qgWb\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"intro\":\"Welcome_intro__2dT5r\",\"msauth\":\"Welcome_msauth__13C0z\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"timeDisplay\":\"Calendar_timeDisplay__3-YgE\"};","import { LogLevel } from \"@azure/msal-browser\";\n// Browser check variables\n// If you support IE, our recommendation is that you sign-in using Redirect APIs\n// If you as a developer are testing using Edge InPrivate mode, please add \"isEdge\" to the if check\nconst ua = window.navigator.userAgent;\nconst msie = ua.indexOf(\"MSIE \");\nconst msie11 = ua.indexOf(\"Trident/\");\nconst msedge = ua.indexOf(\"Edge/\");\nconst firefox = ua.indexOf(\"Firefox\");\nconst isIE = msie > 0 || msie11 > 0;\nconst isEdge = msedge > 0;\nconst isFirefox = firefox > 0; // Only needed if you need to support the redirect flow in Firefox incognito\n\n// Config object to be passed to Msal on creation\nexport const msalConfig = {\n    auth: {\n        clientId: process.env.REACT_APP_AZURE_CLIENT_ID,\n        authority: \"https://login.microsoftonline.com/common\",\n        redirectUri: \"/whatsnext/\"\n    },\n    cache: {\n        cacheLocation: \"sessionStorage\", // This configures where your cache will be stored\n        storeAuthStateInCookie: isIE || isEdge || isFirefox\n    },\n    system: {\n        loggerOptions: {\n            loggerCallback: (level, message, containsPii) => {\n                if (containsPii) {\n                    return;\n                }\n                switch (level) {\n                    case LogLevel.Error:\n                        console.error(message);\n                        return;\n                    case LogLevel.Info:\n                        console.info(message);\n                        return;\n                    case LogLevel.Verbose:\n                        console.debug(message);\n                        return;\n                    case LogLevel.Warning:\n                        console.warn(message);\n                        return;\n                    default:\n                        return;\n                }\n            }\n        }\n    }\n};\n\n// Add here scopes for id token to be used at MS Identity Platform endpoints.\nexport const loginRequest = {\n    scopes: [\"User.Read\", \"Calendars.Read\"]\n};\n\n// Add here the endpoints for MS Graph API services you would like to use.\nexport const graphConfig = {\n    graphMeEndpoint: 'https://graph.microsoft.com/v1.0/me/calendar/calendarView'\n};","import { loginRequest, graphConfig } from \"../authConfig\";\nimport { msalInstance } from \"../index\";\nimport dayjs from \"dayjs\";\n\nexport async function callMsGraph() {\n    const account = msalInstance.getActiveAccount();\n    if (!account) {\n        throw Error(\"No active account! Verify a user has been signed in and setActiveAccount has been called.\");\n    }\n\n    const response = await msalInstance.acquireTokenSilent({\n        ...loginRequest,\n        account: account\n    });\n\n    const headers = new Headers();\n    const bearer = `Bearer ${response.accessToken}`;\n\n    headers.append(\"Authorization\", bearer);\n\n    const options = {\n        method: \"GET\",\n        headers: headers\n    };\n\n    const start = dayjs().subtract(1, 'hour');\n    const end = dayjs().add(1, 'day');\n    const url = `${graphConfig.graphMeEndpoint}?StartDateTime=${start.toISOString()}&EndDateTime=${end.toISOString()}`\n\n    return fetch(url, options)\n        .then(response => response.json())\n        .catch(error => console.log(error));\n}","import React from 'react'\nimport {easeInOutCubic} from 'js-easing-functions';\nimport styles from './Event.module.css';\nimport classNames from 'classnames';\n\nconst _0 = (value) => {\n    return `${value}`.padStart(2, '0')\n}\n\nconst getBlendColors = diff => {\n    // 900 - 15 minutes\n    // 600 - 10 minutes\n    // 300 - 5 minutes\n    if (diff > 900 | diff < -300) {\n        return {}\n    }\n    const alphaValue = Math.min(300, 900 - diff);\n    const greenValue = Math.max(0, Math.min(300, diff));\n    const redValue = Math.max(0, Math.min(300, 600-diff));\n\n    const r = easeInOutCubic(redValue, 0, 128, 300);\n    const g = easeInOutCubic(greenValue, 0, 128, 300);\n    const a = easeInOutCubic(alphaValue, 0, 1,300);\n\n    return {backgroundColor: `rgba(${r}, ${g}, 0, ${a})`};\n}\n\nexport const formatCountdown = (event) => {\n    const diffInSecs = Math.floor(event.timeinfo.timeDiff / 1000);\n    const absDiff = Math.abs(diffInSecs);\n    const hours = Math.floor(absDiff /  3600 )\n    const minutes = Math.floor(absDiff / 60 - (hours * 60))\n    const seconds = Math.floor(absDiff - (hours * 3600) - (minutes * 60))\n\n    let timeRep = \"\";\n    if (event.timeinfo.timeDiff < 0) {\n        timeRep += 'T+ ';\n    }\n    if (hours > 0) {\n        timeRep += `${hours}h ${_0(minutes)}m`;\n    } else if (minutes > 9) {\n        timeRep += `${minutes}m`;\n    } else {\n        timeRep += `${minutes}m ${_0(seconds)}s`;\n    }\n    return timeRep;\n}\n\nconst Event = ({event}) => {\n    const diffInSecs = Math.floor(event.timeinfo.timeDiff / 1000);\n    const flashClass = diffInSecs <= 60 && diffInSecs > -300 ? styles.flash: '';\n    const pastClass = diffInSecs < -300 ? styles.past: '';\n\n    const timeRep = formatCountdown(event);\n\n    return (\n        <li className={classNames(styles.event, flashClass, pastClass)}\n            style={diffInSecs > 60 ? getBlendColors(diffInSecs) : {}}>\n            <span className={styles.time}>{event.timeinfo.startRep}</span>\n            <span className={styles.title}>{event.subject}</span>\n            <span className={styles.diff}>{timeRep}</span>\n        </li>\n    )\n};\n\nexport default Event;","import React from 'react'\nimport styles from './MadeByKaj.module.css';\n\nconst requestFullscreen = () => {\n    if (!document.fullscreenElement) {\n        document.documentElement.requestFullscreen();\n    } else if (document.exitFullscreen) {\n        document.exitFullscreen();\n    }\n}\n\nconst MadeByKaj = () => {\n    return (\n        <>\n            <footer className={styles.love}>\n                <div>Made with ❤️ by <a href=\"https://github.com/kws\">Kaj</a></div>\n            </footer>\n            <span className={styles.forkongithub}>\n                <a href=\"https://github.com/kws/whatsnext\">Fork me on GitHub</a>\n            </span>\n            <button className={styles.fullScreen} onClick={requestFullscreen}><span>Full</span></button>\n        </>\n\n    )\n}\n\nexport default MadeByKaj;","import React from 'react'\nimport { useEffect, useState } from \"react\";\nimport {Helmet} from \"react-helmet\";\n\nimport { useMsal } from \"@azure/msal-react\";\nimport { InteractionStatus } from \"@azure/msal-browser\";\nimport dayjs from \"dayjs\";\n\nimport { callMsGraph } from \"../utils/MsGraphApiCall\";\nimport Event, {formatCountdown} from \"./Event\";\nimport MadeByKaj from \"./MadeByKaj\";\nimport styles from \"./Calendar.module.css\";\n\nconst RELOAD_INTERVAL_IN_MINUTES = 1;\n\nconst loadAndPrepareData = async () => {\n    const graphData = await callMsGraph();\n    const events = (graphData && graphData.value) ? graphData.value : [];\n    events.sort((a, b) => a.start.dateTime.localeCompare(b.start.dateTime));\n    events.map(event => {\n        const start = new Date(event.start.dateTime+\"Z\")\n        const end = new Date(event.end.dateTime+\"Z\")\n        const startRep = dayjs(start).format(\"HH:mm\")\n        event.timeinfo = {start, end, startRep}\n        return event;\n    });\n    console.log(\"events\", events);\n    return events;\n};\n\nconst Calendar = () => {\n    const { inProgress } = useMsal();\n    const [events, setEvents] = useState([]);\n    const [time, setTime] = useState(new Date().getTime());\n\n    useEffect(() => {\n        if (inProgress === InteractionStatus.None) {\n            loadAndPrepareData().then(events => {\n                setEvents(events);\n            });\n        }\n    }, [inProgress]);\n\n    useEffect(() => {\n        const timer = setInterval(() => {\n            setTime(new Date().getTime());\n        }, 1000);\n        return () => {\n            console.log(\"Stopping timer\");\n            clearInterval(timer);\n        }\n    },[]);\n\n    useEffect(() => {\n        const timer = setInterval(() => {\n            if (inProgress === InteractionStatus.None) {\n                loadAndPrepareData().then(events => {\n                    setEvents(events);\n                });\n            }\n        }, RELOAD_INTERVAL_IN_MINUTES * 60 * 1000);\n        return () => {\n            console.log(\"Stopping timer\");\n            clearInterval(timer);\n        }\n    }, [inProgress]);\n\n    events.map(event => {\n        event.timeinfo.timeDiff = event.timeinfo.start - time;\n        event.timeinfo.timeDiffSecs = Math.floor(event.timeinfo.timeDiff / 1000);\n\n        const offsetDiff = Math.min(1200, event.timeinfo.timeDiffSecs + 300);\n        event.timeinfo.alertStatus = offsetDiff > 0 ? 1200 - offsetDiff : 0;\n\n        event.timeinfo.started = event.timeinfo.start >= time;\n        event.timeinfo.ended = event.timeinfo.end >= time;\n        return event;\n    });\n\n    const currentEvents = events.filter(event => event.timeinfo.ended && !event.isAllDay && !event.isCancelled)\n\n    const maxAlertStatus = events.reduce((value, event) => Math.max(value, event.timeinfo.alertStatus), 0)\n\n    let currentTime = dayjs().format(\"H:mm\")\n    if ((Math.floor(time / 1000)) % 2 === 0) {\n        currentTime = currentTime.replace(\":\", \" \");\n    }\n\n    const nextEvent = currentEvents.length > 0 ? currentEvents[0] : null;\n    let icon = '1-favicon.ico';\n    if (maxAlertStatus > 600) {\n        icon = maxAlertStatus % 2 === 0 ? '3-favicon.ico' : 'alert-favicon.ico';\n    } else if (maxAlertStatus > 400) {\n        icon = '2-favicon.ico';\n    }\n\n    return (\n        <>\n            <Helmet>\n                <title>{nextEvent ? `${formatCountdown(nextEvent).replaceAll(' ', '')} ${nextEvent.subject}` : \"WhatsNext\"}</title>\n                <link rel=\"icon\" href={process.env.PUBLIC_URL + `/${icon}`} />\n            </Helmet>\n            <div className={styles.timeDisplay}>{currentTime}</div>\n            <ul>\n                {currentEvents.map(event => <Event key={event.id} event={event}/>)}\n            </ul>\n            <MadeByKaj />\n        </>\n    )\n\n}\n\nexport default Calendar;","import React from 'react'\nimport {loginRequest} from \"../authConfig\";\nimport {useMsal} from \"@azure/msal-react\";\nimport styles from \"./Welcome.module.css\";\n\n\nconst Welcome = () => {\n    const { instance } = useMsal();\n\n    return (\n        <div className={styles.intro}>\n            <h1>What's Next?</h1>\n            <p>\n                Do you ever look at the calendar, or get a reminder from Outlook that you have a meeting\n                starting in 10 minutes? Just enough time to answer a couple of emails... and then suddenly you\n                are 10 minutes late instead?\n            </p>\n            <p>\n                What's Next is an unobtrusive countdown until your next Zoom...\n            </p>\n            <div className={styles.msauth} >\n                <button onClick={() => instance.acquireTokenPopup(loginRequest)}>\n                    <span>Login</span>\n                </button>\n            </div>\n        </div>\n    )\n}\n\nexport default Welcome;","import React from 'react'\nimport { useMsal } from \"@azure/msal-react\";\nimport Calendar from \"./components/Calendar\";\nimport Welcome from \"./components/Welcome\";\nimport MadeByKaj from \"./components/MadeByKaj\";\n\nexport function App() {\n    const { accounts, inProgress } = useMsal();\n\n    let Component;\n    if (accounts.length > 0) {\n        Component = Calendar;\n    } else if (inProgress === \"login\") {\n        Component = () => <div>Login is currently in progress!</div>;\n    } else {\n        Component = Welcome;\n    }\n\n    return (\n        <>\n            <Component />\n            <MadeByKaj />\n        </>\n    )\n}\n\nexport default App;","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport * as Sentry from \"@sentry/react\";\nimport { Integrations } from \"@sentry/tracing\";\nimport { MsalProvider } from \"@azure/msal-react\";\nimport { PublicClientApplication, EventType } from \"@azure/msal-browser\";\nimport { msalConfig } from \"./authConfig\"\nimport './index.css';\nimport App from './App';\n\nconst SENTRY_DSN = process.env.REACT_APP_SENTRY_DSN\n\nif (SENTRY_DSN) {\n    Sentry.init({\n        dsn: SENTRY_DSN,\n        integrations: [new Integrations.BrowserTracing()],\n        tracesSampleRate: 1.0,\n    });\n}\n\nexport const msalInstance = new PublicClientApplication(msalConfig);\n\nconst accounts = msalInstance.getAllAccounts();\nif (accounts.length > 0) {\n    msalInstance.setActiveAccount(accounts[0]);\n}\n\nmsalInstance.addEventCallback((event) => {\n    console.log(\"msalInstance event\", event)\n    if (event.eventType === EventType.LOGIN_SUCCESS && event.payload.account) {\n        const account = event.payload.account;\n        msalInstance.setActiveAccount(account);\n    }\n});\n\n// Component\nconst AppProvider = () => (\n    <MsalProvider instance={msalInstance}>\n        <App />\n    </MsalProvider>\n);\n\n\nReactDOM.render(<AppProvider />, document.getElementById(\"root\"));\n\n"],"sourceRoot":""}