(this.webpackJsonpwhatsnext=this.webpackJsonpwhatsnext||[]).push([[0],{38:function(e,t,n){},42:function(e,t,n){"use strict";n.r(t),n.d(t,"msalInstance",(function(){return C}));var r=n(2),c=n(27),o=n.n(c),a=n(49),s=n(30),i=n(13),u=n(3),l=window.navigator.userAgent,d=l.indexOf("MSIE "),g=l.indexOf("Trident/"),h=l.indexOf("Edge/"),b=l.indexOf("Firefox"),f={auth:{clientId:"212b434a-82b7-43bb-b48d-c8921a2e939d",authority:"https://login.microsoftonline.com/common",redirectUri:"/whatsnext/"},cache:{cacheLocation:"sessionStorage",storeAuthStateInCookie:d>0||g>0||h>0||b>0},system:{loggerOptions:{loggerCallback:function(e,t,n){if(!n)switch(e){case u.e.Error:return void console.error(t);case u.e.Info:return void console.info(t);case u.e.Verbose:return void console.debug(t);case u.e.Warning:return void console.warn(t);default:return}}}}},p={scopes:["User.Read","Calendars.Read"]},j=new Date;j.setHours(0),j.setMinutes(0),j.setSeconds(0);var v=j.toISOString();j.setDate(j.getDate()+1);var O=j.toISOString(),m={graphMeEndpoint:"https://graph.microsoft.com/v1.0/me/calendar/calendarView?StartDateTime=".concat(v,"&EndDateTime=").concat(O)},x=(n(38),n(31)),w=n(19),S=n.n(w),A=n(22),T=n(28);function y(){return(y=Object(T.a)(S.a.mark((function e(){var t,n,r,c,o;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=C.getActiveAccount()){e.next=3;break}throw Error("No active account! Verify a user has been signed in and setActiveAccount has been called.");case 3:return e.next=5,C.acquireTokenSilent(Object(A.a)(Object(A.a)({},p),{},{account:t}));case 5:return n=e.sent,r=new Headers,c="Bearer ".concat(n.accessToken),r.append("Authorization",c),o={method:"GET",headers:r},e.abrupt("return",fetch(m.graphMeEndpoint,o).then((function(e){return e.json()})).catch((function(e){return console.log(e)})));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var E=n(5),k=function(){var e=Object(i.b)().inProgress,t=Object(r.useState)(null),n=Object(x.a)(t,2),c=n[0],o=n[1];Object(r.useEffect)((function(){e===u.c.None&&function(){return y.apply(this,arguments)}().then((function(e){return o(e)}))}),[e]),console.log("GraphData",c);var a=c&&c.value?c.value:[];return a.sort((function(e,t){return e.start.dateTime.localeCompare(t.start.dateTime)})),console.log("events",a),Object(E.jsx)("ul",{children:a.map((function(e){return Object(E.jsxs)("li",{children:[new Date(e.start.dateTime).toLocaleTimeString()," - ",e.subject]},e.id)}))})};var I=function(){var e=Object(i.b)(),t=e.instance,n=e.accounts,r=e.inProgress;return console.log("Accounts",n),n.length>0?Object(E.jsxs)(E.Fragment,{children:[Object(E.jsxs)("p",{children:["There are currently ",n.length," users signed in! "]}),Object(E.jsx)(k,{}),Object(E.jsx)("button",{onClick:function(){return t.logout()},children:"Logout"})]}):"login"===r?Object(E.jsx)("span",{children:"Login is currently in progress!"}):Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)("span",{children:"There are currently no users signed in!"}),Object(E.jsx)("button",{onClick:function(){return t.loginPopup(p)},children:"Login"})]})};a.a({dsn:"https://c42f3190b1094dd4b4dd426834da98c6@o108858.ingest.sentry.io/5662792",integrations:[new s.a.BrowserTracing],tracesSampleRate:1});var C=new u.g(f),D=C.getAllAccounts();D.length>0&&C.setActiveAccount(D[0]),C.addEventCallback((function(e){if(console.log("msalInstance event",e),e.eventType===u.b.LOGIN_SUCCESS&&e.payload.account){var t=e.payload.account;C.setActiveAccount(t)}}));var L=function(){return Object(E.jsx)(i.a,{instance:C,children:Object(E.jsx)(I,{})})};o.a.render(Object(E.jsx)(L,{}),document.getElementById("root"))}},[[42,1,2]]]);
//# sourceMappingURL=main.c51c3efe.chunk.js.map