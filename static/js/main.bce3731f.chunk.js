(this.webpackJsonpwhatsnext=this.webpackJsonpwhatsnext||[]).push([[0],{38:function(e,t,n){},42:function(e,t,n){"use strict";n.r(t),n.d(t,"msalInstance",(function(){return y}));var c=n(2),r=n(27),a=n.n(r),s=n(49),o=n(30),i=n(13),u=n(3),d=(n(38),n(31)),l=n(19),b=n.n(l),h=n(22),g=n(28),p=window.navigator.userAgent,j=(p.indexOf("MSIE "),p.indexOf("Trident/"),p.indexOf("Edge/"),p.indexOf("Firefox"),{scopes:["User.Read","Calendars.Read"]}),f=new Date;f.setHours(0),f.setMinutes(0),f.setSeconds(0);var O=f.toISOString();f.setDate(f.getDate()+1);var v=f.toISOString(),x={graphMeEndpoint:"https://graph.microsoft.com/v1.0/me/calendar/calendarView?StartDateTime=".concat(O,"&EndDateTime=").concat(v)};function m(){return(m=Object(g.a)(b.a.mark((function e(){var t,n,c,r,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=y.getActiveAccount()){e.next=3;break}throw Error("No active account! Verify a user has been signed in and setActiveAccount has been called.");case 3:return e.next=5,y.acquireTokenSilent(Object(h.a)(Object(h.a)({},j),{},{account:t}));case 5:return n=e.sent,c=new Headers,r="Bearer ".concat(n.accessToken),c.append("Authorization",r),a={method:"GET",headers:c},e.abrupt("return",fetch(x.graphMeEndpoint,a).then((function(e){return e.json()})).catch((function(e){return console.log(e)})));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var w=n(5),S=function(){var e=Object(i.b)().inProgress,t=Object(c.useState)(null),n=Object(d.a)(t,2),r=n[0],a=n[1];Object(c.useEffect)((function(){e===u.c.None&&function(){return m.apply(this,arguments)}().then((function(e){return a(e)}))}),[e]),console.log("GraphData",r);var s=r&&r.value?r.value:[];return s.sort((function(e,t){return e.start.dateTime.localeCompare(t.start.dateTime)})),console.log("events",s),Object(w.jsx)("ul",{children:s.map((function(e){return Object(w.jsxs)("li",{children:[new Date(e.start.dateTime).toLocaleTimeString()," - ",e.subject]},e.id)}))})},T={scopes:["Calendars.Read"]};var A=function(){var e=Object(i.b)(),t=e.instance,n=e.accounts,c=e.inProgress;return console.log("Accounts",n),n.length>0?Object(w.jsxs)(w.Fragment,{children:[Object(w.jsxs)("p",{children:["There are currently ",n.length," users signed in! "]}),Object(w.jsx)(S,{}),Object(w.jsx)("button",{onClick:function(){return t.logout()},children:"Logout"})]}):"login"===c?Object(w.jsx)("span",{children:"Login is currently in progress!"}):Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("span",{children:"There are currently no users signed in!"}),Object(w.jsx)("button",{onClick:function(){return t.loginPopup(T)},children:"Login"})]})};s.a({dsn:"https://c42f3190b1094dd4b4dd426834da98c6@o108858.ingest.sentry.io/5662792",integrations:[new o.a.BrowserTracing],tracesSampleRate:1});var y=new u.g({auth:{clientId:"34a2dfb8-fcb2-4c55-8436-ed03b6b7c683"}}),E=y.getAllAccounts();E.length>0&&y.setActiveAccount(E[0]),y.addEventCallback((function(e){if(e.eventType===u.b.LOGIN_SUCCESS&&e.payload.account){var t=e.payload.account;y.setActiveAccount(t)}}));var k=function(){return Object(w.jsx)(i.a,{instance:y,children:Object(w.jsx)(A,{})})};a.a.render(Object(w.jsx)(k,{}),document.getElementById("root"))}},[[42,1,2]]]);
//# sourceMappingURL=main.bce3731f.chunk.js.map