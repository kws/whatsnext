(this.webpackJsonpwhatsnext=this.webpackJsonpwhatsnext||[]).push([[0],{15:function(e,t,n){e.exports={event:"Event_event__1P29_",time:"Event_time__2-mok",title:"Event_title__2DQ5v",diff:"Event_diff__1q_Qg",past:"Event_past__VN_ps",flash:"Event_flash__3EET6",alert:"Event_alert__1gP6J",blinker:"Event_blinker__9dt53"}},24:function(e,t,n){e.exports={love:"MadeByKaj_love__39zpn",forkongithub:"MadeByKaj_forkongithub__1xnhH",fullScreen:"MadeByKaj_fullScreen__3qgWb"}},27:function(e,t,n){e.exports={intro:"Welcome_intro__2dT5r",msauth:"Welcome_msauth__13C0z"}},40:function(e,t,n){e.exports={timeDisplay:"Calendar_timeDisplay__3-YgE"}},49:function(e,t,n){},55:function(e,t,n){"use strict";n.r(t),n.d(t,"msalInstance",(function(){return Y}));var a=n(1),c=n(35),r=n.n(c),i=n(62),o=n(42),s=n(11),u=n(3),l=window.navigator.userAgent,f=l.indexOf("MSIE "),d=l.indexOf("Trident/"),m=l.indexOf("Edge/"),h=l.indexOf("Firefox"),b={auth:{clientId:"5cc7cfe1-9d09-4d62-bcb1-aaf0033854b7",authority:"https://login.microsoftonline.com/common",redirectUri:"/whatsnext/"},cache:{cacheLocation:"sessionStorage",storeAuthStateInCookie:f>0||d>0||m>0||h>0},system:{loggerOptions:{loggerCallback:function(e,t,n){if(!n)switch(e){case u.e.Error:return void console.error(t);case u.e.Info:return void console.info(t);case u.e.Verbose:return void console.debug(t);case u.e.Warning:return void console.warn(t);default:return}}}}},j={scopes:["User.Read","Calendars.Read"]},v="https://graph.microsoft.com/v1.0/me/calendar/calendarView",p=(n(49),n(30)),x=n(16),O=n.n(x),g=n(21),_=n(36),w=n(17),y=n.n(w),k=n(31);function E(){return S.apply(this,arguments)}function S(){return(S=Object(g.a)(O.a.mark((function e(){var t,n,a,c,r,i,o,s;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Y.getActiveAccount()){e.next=3;break}throw Error("No active account! Verify a user has been signed in and setActiveAccount has been called.");case 3:return e.next=5,Y.acquireTokenSilent(Object(k.a)(Object(k.a)({},j),{},{account:t}));case 5:return n=e.sent,a=new Headers,c="Bearer ".concat(n.accessToken),a.append("Authorization",c),r={method:"GET",headers:a},i=y()().subtract(1,"hour"),o=y()().add(1,"day"),s="".concat(v,"?StartDateTime=").concat(i.toISOString(),"&EndDateTime=").concat(o.toISOString()),e.abrupt("return",fetch(s,r).then((function(e){return e.json()})).catch((function(e){return console.log(e)})));case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var M=n(23),D=n(15),N=n.n(D),T=n(39),I=n.n(T),C=n(2),A=function(e){return"".concat(e).padStart(2,"0")},F=function(e){if(e>900|e<-300)return{};var t=Math.min(300,900-e),n=Math.max(0,Math.min(300,e)),a=Math.max(0,Math.min(300,600-e)),c=Object(M.easeInOutCubic)(a,0,128,300),r=Object(M.easeInOutCubic)(n,0,128,300),i=Object(M.easeInOutCubic)(t,0,1,300);return{backgroundColor:"rgba(".concat(c,", ").concat(r,", 0, ").concat(i,")")}},W=function(e){var t=Math.floor(e.timeinfo.timeDiff/1e3),n=Math.abs(t),a=Math.floor(n/3600),c=Math.floor(n/60-60*a),r=Math.floor(n-3600*a-60*c),i="";return e.timeinfo.timeDiff<0&&(i+="T+ "),i+=a>0?"".concat(a,"h ").concat(A(c),"m"):c>9?"".concat(c,"m"):"".concat(c,"m ").concat(A(r),"s")},B=function(e){var t=e.event,n=Math.floor(t.timeinfo.timeDiff/1e3),a=n<=60&&n>-300?N.a.flash:"",c=n<-300?N.a.past:"",r=W(t);return Object(C.jsxs)("li",{className:I()(N.a.event,a,c),style:n>60?F(n):{},children:[Object(C.jsx)("span",{className:N.a.time,children:t.timeinfo.startRep}),Object(C.jsx)("span",{className:N.a.title,children:t.subject}),Object(C.jsx)("span",{className:N.a.diff,children:r})]})},H=n(24),q=n.n(H),P=function(){document.fullscreenElement?document.exitFullscreen&&document.exitFullscreen():document.documentElement.requestFullscreen()},R=function(){return Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)("footer",{className:q.a.love,children:Object(C.jsxs)("div",{children:["Made with \u2764\ufe0f by ",Object(C.jsx)("a",{href:"https://github.com/kws",children:"Kaj"})]})}),Object(C.jsx)("span",{className:q.a.forkongithub,children:Object(C.jsx)("a",{href:"https://github.com/kws/whatsnext",children:"Fork me on GitHub"})}),Object(C.jsx)("button",{className:q.a.fullScreen,onClick:P,children:Object(C.jsx)("span",{children:"Full"})})]})},J=n(40),K=n.n(J),L=function(){var e=Object(g.a)(O.a.mark((function e(){var t,n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E();case 2:return t=e.sent,(n=t&&t.value?t.value:[]).sort((function(e,t){return e.start.dateTime.localeCompare(t.start.dateTime)})),n.map((function(e){var t=new Date(e.start.dateTime+"Z"),n=new Date(e.end.dateTime+"Z"),a=y()(t).format("HH:mm");return e.timeinfo={start:t,end:n,startRep:a},e})),console.log("events",n),e.abrupt("return",n);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),V=function(){var e=Object(s.b)().inProgress,t=Object(a.useState)([]),n=Object(p.a)(t,2),c=n[0],r=n[1],i=Object(a.useState)((new Date).getTime()),o=Object(p.a)(i,2),l=o[0],f=o[1];Object(a.useEffect)((function(){e===u.c.None&&L().then((function(e){r(e)}))}),[e]),Object(a.useEffect)((function(){var e=setInterval((function(){f((new Date).getTime())}),1e3);return function(){console.log("Stopping timer"),clearInterval(e)}}),[]),Object(a.useEffect)((function(){var t=setInterval((function(){e===u.c.None&&L().then((function(e){r(e)}))}),6e4);return function(){console.log("Stopping timer"),clearInterval(t)}}),[e]),c.map((function(e){e.timeinfo.timeDiff=e.timeinfo.start-l,e.timeinfo.timeDiffSecs=Math.floor(e.timeinfo.timeDiff/1e3);var t=Math.min(1200,e.timeinfo.timeDiffSecs+300);return e.timeinfo.alertStatus=t>0?1200-t:0,e.timeinfo.started=e.timeinfo.start>=l,e.timeinfo.ended=e.timeinfo.end>=l,e}));var d=c.filter((function(e){return e.timeinfo.ended&&!e.isAllDay&&!e.isCancelled})),m=c.reduce((function(e,t){return Math.max(e,t.timeinfo.alertStatus)}),0),h=y()().format("H:mm");Math.floor(l/1e3)%2===0&&(h=h.replace(":"," "));var b=d.length>0?d[0]:null,j="1-favicon.ico";return m>600?j=m%2===0?"3-favicon.ico":"alert-favicon.ico":m>400&&(j="2-favicon.ico"),Object(C.jsxs)(C.Fragment,{children:[Object(C.jsxs)(_.a,{children:[Object(C.jsx)("title",{children:b?"".concat(W(b).replaceAll(" ","")," ").concat(b.subject):"WhatsNext"}),Object(C.jsx)("link",{rel:"icon",href:"/whatsnext"+"/".concat(j)})]}),Object(C.jsx)("div",{className:K.a.timeDisplay,children:h}),Object(C.jsx)("ul",{children:d.map((function(e){return Object(C.jsx)(B,{event:e},e.id)}))}),Object(C.jsx)(R,{})]})},z=n(27),G=n.n(z),U=function(){var e=Object(s.b)().instance;return Object(C.jsxs)("div",{className:G.a.intro,children:[Object(C.jsx)("h1",{children:"What's Next?"}),Object(C.jsx)("p",{children:"Do you ever look at the calendar, or get a reminder from Outlook that you have a meeting starting in 10 minutes? Just enough time to answer a couple of emails... and then suddenly you are 10 minutes late instead?"}),Object(C.jsx)("p",{children:"What's Next is an unobtrusive countdown until your next Zoom..."}),Object(C.jsx)("div",{className:G.a.msauth,children:Object(C.jsx)("button",{onClick:function(){return e.acquireTokenPopup(j)},children:Object(C.jsx)("span",{children:"Login"})})})]})};var Z=function(){var e,t=Object(s.b)(),n=t.accounts,a=t.inProgress;return e=n.length>0?V:"login"===a?function(){return Object(C.jsx)("div",{children:"Login is currently in progress!"})}:U,Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)(e,{}),Object(C.jsx)(R,{})]})},Q="https://c42f3190b1094dd4b4dd426834da98c6@o108858.ingest.sentry.io/5662792";i.a({dsn:Q,integrations:[new o.a.BrowserTracing],tracesSampleRate:1});var Y=new u.g(b),X=Y.getAllAccounts();X.length>0&&Y.setActiveAccount(X[0]),Y.addEventCallback((function(e){if(console.log("msalInstance event",e),e.eventType===u.b.LOGIN_SUCCESS&&e.payload.account){var t=e.payload.account;Y.setActiveAccount(t)}}));var $=function(){return Object(C.jsx)(s.a,{instance:Y,children:Object(C.jsx)(Z,{})})};r.a.render(Object(C.jsx)($,{}),document.getElementById("root"))}},[[55,1,2]]]);
//# sourceMappingURL=main.1b16f938.chunk.js.map