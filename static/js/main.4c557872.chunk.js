(this.webpackJsonpwhatsnext=this.webpackJsonpwhatsnext||[]).push([[0],{38:function(e,t,n){},42:function(e,t,n){"use strict";n.r(t),n.d(t,"msalInstance",(function(){return L}));var r=n(1),a=n(29),c=n.n(a),o=n(49),s=n(31),i=n(13),u=n(2),l=window.navigator.userAgent,d=l.indexOf("MSIE "),f=l.indexOf("Trident/"),p=l.indexOf("Edge/"),h=l.indexOf("Firefox"),b={auth:{clientId:"212b434a-82b7-43bb-b48d-c8921a2e939d",authority:"https://login.microsoftonline.com/common",redirectUri:"/whatsnext/"},cache:{cacheLocation:"sessionStorage",storeAuthStateInCookie:d>0||f>0||p>0||h>0},system:{loggerOptions:{loggerCallback:function(e,t,n){if(!n)switch(e){case u.e.Error:return void console.error(t);case u.e.Info:return void console.info(t);case u.e.Verbose:return void console.debug(t);case u.e.Warning:return void console.warn(t);default:return}}}}},v={scopes:["User.Read","Calendars.Read"]},g=new Date;g.setHours(0),g.setMinutes(0),g.setSeconds(0);var j=g.toISOString();g.setDate(g.getDate()+1);var m=g.toISOString(),O={graphMeEndpoint:"https://graph.microsoft.com/v1.0/me/calendar/calendarView?StartDateTime=".concat(j,"&EndDateTime=").concat(m)},x=(n(38),n(23)),w=n(14),S=n.n(w),y=n(17),T=n(24);function E(){return I.apply(this,arguments)}function I(){return(I=Object(y.a)(S.a.mark((function e(){var t,n,r,a,c;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=L.getActiveAccount()){e.next=3;break}throw Error("No active account! Verify a user has been signed in and setActiveAccount has been called.");case 3:return e.next=5,L.acquireTokenSilent(Object(T.a)(Object(T.a)({},v),{},{account:t}));case 5:return n=e.sent,r=new Headers,a="Bearer ".concat(n.accessToken),r.append("Authorization",a),c={method:"GET",headers:r},e.abrupt("return",fetch(O.graphMeEndpoint,c).then((function(e){return e.json()})).catch((function(e){return console.log(e)})));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var A=n(4),k=function(e){return"".concat(e).padStart(2,"0")},D=function(e){var t=e.event,n=Math.floor(t.startinfo.timeDiff/1e3),r=Math.floor(n/3600),a=Math.floor(n/60-60*r),c=Math.floor(n-3600*r-60*a),o="";return o=n<0?"~ past ~":r>0?"".concat(r,"h ").concat(k(a),"m"):a>9?"".concat(a,"m"):"".concat(a,"m ").concat(k(c),"s"),Object(A.jsxs)("li",{className:"event",children:[Object(A.jsx)("span",{className:"diff",children:o}),Object(A.jsx)("span",{className:"title",children:t.subject}),Object(A.jsx)("span",{className:"time",children:t.startinfo.timeRep})]})},M=function(){var e=Object(y.a)(S.a.mark((function e(){var t,n;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E();case 2:return t=e.sent,(n=t&&t.value?t.value:[]).sort((function(e,t){return e.start.dateTime.localeCompare(t.start.dateTime)})),n.map((function(e){var t=new Date(e.start.dateTime+"Z"),n="".concat(t.getHours()).padStart(2,"0")+":"+"".concat(t.getMinutes()).padStart(2,"0");return e.startinfo={date:t,timeRep:n},e})),console.log("events",n),e.abrupt("return",n);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),N=function(){var e=Object(i.b)().inProgress,t=Object(r.useState)([]),n=Object(x.a)(t,2),a=n[0],c=n[1],o=Object(r.useState)((new Date).getTime()),s=Object(x.a)(o,2),l=s[0],d=s[1];Object(r.useEffect)((function(){e===u.c.None&&M().then((function(e){c(e)}))}),[e]),Object(r.useEffect)((function(){var e=setInterval((function(){d((new Date).getTime())}),1e3);return function(){console.log("Stopping timer"),clearInterval(e)}}),[]),Object(r.useEffect)((function(){var t=setInterval((function(){e===u.c.None&&M().then((function(e){c(e)}))}),6e4);return function(){console.log("Stopping timer"),clearInterval(t)}}),[e]),a.map((function(e){return e.startinfo.timeDiff=e.startinfo.date-l,e}));var f=new Date(l).toLocaleTimeString("en-GB",{timeStyle:"short"});return Math.floor(l/1e3)%2===0&&(f=f.replace(":"," ")),Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)("div",{className:"timeDisplay",children:f}),Object(A.jsx)("ul",{children:a.map((function(e){return Object(A.jsx)(D,{event:e},e.id)}))})]})};var C=function(){var e=Object(i.b)(),t=e.instance,n=e.accounts,r=e.inProgress;return n.length>0?Object(A.jsx)(N,{}):"login"===r?Object(A.jsx)("div",{children:"Login is currently in progress!"}):Object(A.jsxs)("div",{children:[Object(A.jsx)("span",{children:"Please log in to view your upcoming events."}),Object(A.jsx)("button",{onClick:function(){return t.acquireTokenPopup(v)},children:"Login"})]})};o.a({dsn:"https://c42f3190b1094dd4b4dd426834da98c6@o108858.ingest.sentry.io/5662792",integrations:[new s.a.BrowserTracing],tracesSampleRate:1});var L=new u.g(b),R=L.getAllAccounts();R.length>0&&L.setActiveAccount(R[0]),L.addEventCallback((function(e){if(console.log("msalInstance event",e),e.eventType===u.b.LOGIN_SUCCESS&&e.payload.account){var t=e.payload.account;L.setActiveAccount(t)}}));var B=function(){return Object(A.jsx)(i.a,{instance:L,children:Object(A.jsx)(C,{})})};c.a.render(Object(A.jsx)(B,{}),document.getElementById("root"))}},[[42,1,2]]]);
//# sourceMappingURL=main.4c557872.chunk.js.map